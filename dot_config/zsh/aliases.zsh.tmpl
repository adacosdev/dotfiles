# Git Shortcuts
alias gs="git status" # > View git status
alias ga="git add ." # > Add all changes to git
alias gc="git commit -m" # > Create a commit with message
alias gp="git push" # > Push changes to repository
{{ if eq .chezmoi.osRelease.id "arch" "endeavouros" -}}
alias lg="lazygit" # > Terminal UI for Git
{{ else if eq .chezmoi.osRelease.id "ubuntu" "debian" -}}
# Lazygit might need manual install/PPA on some Ubuntus, but let's assume it's there or user installs it
alias lg="lazygit" # > Terminal UI for Git
{{ end -}}

# Node/Project Shortcuts
alias ni="npm install" # > Install node dependencies
alias nd="npm run dev" # > Start node development server
alias nb="npm run build" # > Build node project

# System Shortcuts
alias cls="clear" # > Clear terminal

# Help / Cheatsheet
# Unalias h if it exists to avoid conflicts when defining the function
unalias h 2>/dev/null || true

h() {
    local alias_file="${HOME}/.config/zsh/aliases.zsh"
    echo -e "\n\033[1;36mðŸ’Š Dotfiles Cheatsheet\033[0m\n"
    
    if [[ -f "$alias_file" ]]; then
        # Extract commented aliases from this file
        # Pattern looks for: alias name=... # > Description
        # We process the file safely, even if no matches found
        grep "alias " "$alias_file" | grep "# >" | \
        sed 's/alias \([^=]*\)=.* # > \(.*\)/\1:\2/' | \
        awk -F':' '{printf "\033[0;33m%-10s\033[0m %s\n", $1, $2}' || echo "No aliases to display."
    else
        echo "âš ï¸  Aliases file not found ($alias_file)"
    fi
    
    echo ""
}

# History Search (hs)
if command -v fzf &> /dev/null; then
  hs() {
    local cmd
    # fc -l (list) -n (no numbers) -r (reverse order) 1 (all history)
    cmd=$(fc -lnr 1 | fzf --no-sort --exact --query "$1")
    
    if [ -n "$cmd" ]; then
        print -s "$cmd" # Add to history
        eval "$cmd"     # Execute
    fi
  }
else
  alias hs="history 0"
fi


# Fast Navigation
alias ..="cd .." # > Go up one directory level
alias ...="cd ../.." # > Go up two directory levels

# Docker (Time saver)
alias d="docker" # > Docker base command
alias dc="docker-compose" # > Docker-compose base command
alias dcu="docker-compose up -d" # > Start docker services in background
alias dcd="docker-compose down" # > Stop and remove docker services
alias dcl="docker-compose logs -f" # > View docker logs in real time

# Network Tools (Check occupied ports)
alias ports="sudo lsof -i -P -n | grep LISTEN" # > View listening ports

# Update System (Distro Agnostic)
{{ if eq .chezmoi.osRelease.id "arch" "endeavouros" -}}
alias update-all='sudo pacman -Syu && yay -Sua && chezmoi update' # > Update system and dotfiles (Arch)
{{ else if eq .chezmoi.osRelease.id "ubuntu" "debian" -}}
alias update-all='sudo apt update && sudo apt upgrade -y && chezmoi update' # > Update system and dotfiles (Debian/Ubuntu)
{{ else -}}
alias update-all='chezmoi update' # > Update system not supported, just dotfiles
{{ end -}}

# Bat instead of cat (Smart check)
if command -v bat &> /dev/null; then
    alias cat='bat --paging=never' # > Cat with syntax highlighting (bat)
elif command -v batcat &> /dev/null; then
    alias cat='batcat --paging=never' # > Cat with syntax highlighting (batcat)
fi


# Eza instead of ls (Smart check)
if command -v eza &> /dev/null; then
    alias ls='eza --icons --group-directories-first' # > List files with icons (eza)
    alias ll='eza -lh --icons --grid --group-directories-first' # > List details with icons (eza)
    alias tree='eza --tree --icons' # > Tree view with icons (eza)
elif command -v exa &> /dev/null; then
    # Compatibility with older versions
    alias ls='exa --icons --group-directories-first' # > List files with icons (exa)
    alias ll='exa -lh --icons --grid --group-directories-first' # > List details with icons (exa)
    alias tree='exa --tree --icons' # > Tree view with icons (exa)
else
    # Fallback to standard ls
    alias ll='ls -la --color=auto' # > List details (standard)
fi

alias ce='chezmoi edit' # > Edit chezmoi config
alias ca='chezmoi apply' # > Apply chezmoi changes
alias cdz='chezmoi cd' # > Change to chezmoi directory
alias cs='chezmoi status' # > View chezmoi status
alias capply='chezmoi apply && source ~/.zshrc' # > Apply chezmoi and reload terminal
